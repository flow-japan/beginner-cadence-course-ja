# 第 2 章 - 1 日目 - 初めてのスマートコントラクト

皆さんこんにちは！この章では、実際に Cadence のコードに飛び込んでいきましょう。

今日は、皆さんにとって初めてのスマートコントラクトを実装し、Cadence の基本を学びます。これはつまり、変数の宣言の仕方、関数の書き方を学んでいくことを意味します。

## 動画

動画で学びたい方は以下の二つをご参照ください。

1. [https://www.youtube.com/watch?v=QbqNM4k76B0](https://www.youtube.com/watch?v=QbqNM4k76B0) (スマートコントラクト、アカウントの概要とどうやってデプロイするか)
2. [https://www.youtube.com/watch?v=DSwNNOEdBXU](https://www.youtube.com/watch?v=DSwNNOEdBXU) (基本的な関数とコントラクトのデプロイの裏側)

注意: 00:00 - 07:23 を見てみてください。 07:23 以降はこちらの記事ではカバーされていません。

## はじめてのスマートコントラクト

皆さんはすでに、第 1 章 1 日目を読んでますか？この章には、スマートコントラクトについて知っておくべきことをすべて網羅していますので細かく進めていきましょう。

最初のスマートコントラクトを作り始める前に、まず、どこで作成するかを確認してみましょう。任意のブラウザ（Google Chrome をお勧めします）を起動し、次の URL を貼り付けて Flow プレイグラウンドを開いてください。：[https://play.onflow.org](https://play.onflow.org/)。その後、以下の操作を行います。

1. 左側にある「0x01」タブをクリックします。
2. そのページ内のすべてを削除します。

すると次のように表示がされます。：

![https://github.com/emerald-dao/beginner-cadence-course/raw/main/chapter2.0/images/blanksc.png](https://github.com/emerald-dao/beginner-cadence-course/raw/main/chapter2.0/images/blanksc.png)

この作業は、アドレス `0x01` のアカウントをクリックし、そのアカウント内のコントラクトを削除したことを意味します。ここで、重要なトピックがあります。

### アドレスとは何でしょうか？

アドレスとは、`0x` から始まり、その後にランダムな数字や文字が並んでいます。こちらが Flow 上のアドレスの例です：`0xe5a8b7f23e8b548f`

Flow プレイグラウンドでは、`0x01` のようなもっと短いアドレスが表示されます。これは、単純化して表示するためにこのようにしています。

アドレスとは何なのでしょうか。アドレスは、アカウントに近いものです。ブロックチェーン上で何かをしたいとき、アカウントが必要です。すべてのアカウントには、それに関連するアドレスがあります。そのため、`0xe5a8b7f23e8b548f` のようなアドレスは単に、データの保存やトランザクションの送信などに使用する、ある人のアカウントです。

### スマートコントラクトはどこにあるのか？

スマートコントラクトは、アカウントに保存されます。上で述べたように、アカウントはユーザーによって所有され、すべてのアカウントには、常に `0x` で始まるアドレスが関連付けられています。Flow プレイグラウンドの場合、`0x01`、`0x02` …のように 5 つのアカウントが自動的に与えられています。

このように、スマートコントラクトはアドレス上に存在します。つまり、「Hello World」という名前のコントラクトをアカウント `0x01` にデプロイすると、このコントラクトはアドレスで識別されます。

このコントラクトと対話するには、コントラクトの名前とアドレスの両方を知らなければなりません。これについては、後ほどインポートするときに詳しく説明します。

### 話を例に戻すと...

この例では、スマートコントラクトをアカウント `0x01` にデプロイする予定です。これは、アカウント `0x01` がこのスマートコントラクトの **所有者** であることを意味します。現実世界では、あなたは **あなたの** アカウントにスマートコントラクトをデプロイしますが、プレイグラウンドはシミュレーションの世界で好きなアカウントを選べるので、`0x01` を選択しました。

では、コントラクトを作ってみましょう。空いたスペースに、次のように入力します。

```cadence
pub contract HelloWorld {

    init() {

    }
}
```

`pub contract [contract name]` は、新しいコントラクトを作成するときに常に記述するものになります。`contract name` には、あなたがコントラクトをそう呼びたい名前を何でも記述できます。

`init()` 関数は、すべてのコントラクトが必ず持っていなければならない関数です。この関数は、コントラクトが最初にデプロイされるときに呼び出されるもので、これは実際には一度だけ起こります。そのため、私たちはこの中で、あるもの（※訳注：もの＝フィールド）を望むように初期化できます。

これで最初のスマートコントラクトが完成です！ただし、このスマートコントラクトは何もしません ;( このコントラクトにデータを格納できるように、`greeting` 変数を格納するようにしましょう。

コントラクトのコードを修正して、以下のようにします。

```cadence
pub contract HelloWorld {

    pub let greeting: String

    init() {
        self.greeting = "Hello, World!"
    }
}
```

Cadence では、変数を宣言するとき、次のように実行します。

`[アクセス修飾子] [var/let] [変数名]: [型]`

上の例で言うと...

- アクセス修飾子は `pub` で、誰でもこの変数を読めるという意味です。将来的には、他のアクセス修飾子もたくさん出てくるでしょうが、これからの数回のレッスンでは、簡単にするために `pub` だけを使うことにしましょう。
- `let` は、この変数が定数であることを意味します。他のプログラミング言語でコーディングしたことがある人なら、定数というのは、この変数に一度何かを代入すると、それを **変更できない** ことを意味します。一方、`var` は変更可能であることを意味します。
- この変数の名前は `greeting` です。
- この変数の型は `String` です。つまり、「こんにちは」「ジェイコブは最高です」「ジェイコブを愛しています」などの言葉を入れることができます。

次に、`self.greeting = "Hello, World!"` が `init()` 関数の中に書かれています。`init()` 関数はコントラクトがデプロイされるときに必ず一度だけ呼ばれることを思い出してください。`self` は、「一つ上の層の変数」を意味するキーワードです。この場合、`self.greeting` はそのすぐ上で宣言した `greeting` 変数を参照しており、それを `"Hello, World!"` と等しい値に設定しています。

このコントラクトをデプロイするには、緑色の「Deploy」ボタンをクリックします。ページはこのように表示されるはずです。

![https://github.com/emerald-dao/beginner-cadence-course/raw/main/chapter2.0/images/helloworld.png](https://github.com/emerald-dao/beginner-cadence-course/raw/main/chapter2.0/images/helloworld.png)

注意: もしエラーが発生した場合は、まずページを更新してみてください。それでもまだ、次のようなエラーが表示される場合は、ページを更新してみてください。「GraphQL error」のようなエラーが表示される場合は、ブラウザを Google Chrome に切り替えてみてください。

やったー！あなたは最初のスマートコントラクトをデプロイしました。

## greeting の値を読む

`greeting` 変数に実際に「Hello, World!」が設定されていることを確認しましょう。先ほどもご説明した通り、スクリプトを使ってブロックチェーンのデータを見ることができます。

左側の「Script Templates」の下にある「Script」というタブをクリックし、その中のものをすべて削除してください。次に、以下のコードを書きます。

```cadence
import HelloWorld from 0x01

pub fun main(): String {
    return HelloWorld.greeting
}
```

このスクリプトは、`greeting` の値、つまり「Hello, World!」を返します。私たちが書いたコードが何をしたのか詳しくみてみましょう。

1. まず、`import HelloWorld from 0x01` を実行し、スマートコントラクトをインポートしました。Cadence では、コントラクトをインポートするには… `import [コントラクト名] from [コントラクトのアドレス]` を実行する必要があります。
2. 次に関数を書きました。Cadence では、`[アクセス修飾子] fun [関数名]:[戻り値の型] { ... }`と書いて関数を書きます。 この場合、アクセス修飾子に `pub` を使い（詳細は後述）、関数名を `main` とし、返り値を `String` 型としました。（これは `greeting` の型のことです。）
3. そして、`HelloWorld.greeting` を使ってコントラクトから `greeting` 変数にアクセスしました。

右側の「Execute」をクリックすると、ターミナルに以下のように「Hello, World!」と表示されるのがわかります。

![https://github.com/emerald-dao/beginner-cadence-course/raw/main/chapter2.0/images/hwscript.png](https://github.com/emerald-dao/beginner-cadence-course/raw/main/chapter2.0/images/hwscript.png)

このように表示されたら、最初のスクリプトが実行されたことになります。

## スマートコントラクトの概念を理解しよう

さて、コードを書き終わりました。速いですねぇ。でも、これが第 1 章 1 日目でお話ししたこととどう関係するのでしょうか？

スマートコントラクトはプログラムであり、ルールブックでもあると言いましたね。スマートコントラクトは私たちに一定のことを行うことを許可します、それ以上でもそれ以下でもありません。

今回の例では、スマートコントラクトによって、`greeting` の初期化と `greeting` の読み出しがができるようになっています。

しかし、`greeting` を他のものに変更することは絶対にできません。もしそのような機能を追加したければ、デプロイする前に前もってそうする必要があります。スマートコントラクト開発者とって最も重要なのは、コントラクトをデプロイする前にユーザーに持たせたい機能をすべて実装する必要があることです。なぜなら、デプロイした後にできることは何もないからです。

(もちろん、Flow プレイグラウンドでは、コントラクトを再びデプロイすることができます。しかし、実際にはこのようなことはできません。)

## まとめ

今日は、最初のコントラクトをデプロイする方法、変数を宣言する方法、関数を書く方法、そしてスクリプトを実行する方法を学びました。すごい! それはたくさんありますね。でも、そんなに悪くはないでしょう？

## クエスト

今日のクエストでは、このレッスンで行ったのと同じように、[https://play.onflow.org](https://play.onflow.org/) にアクセスして新しい Flow プレイグラウンドをロードし、このプレイグラウンドを使ってコードを書いてください。

1. アカウント `0x03` に「JacobTucker」というコントラクトをデプロイし、そのコントラクトの中で `is` という名前の **定数の** 変数を宣言します。その型は `String` にします。コントラクト・デプロイ時に、この変数を「the best」に初期化してください。

2. 変数 `is` が実際に「the best」に等しいことを、その変数を読み込むスクリプトを実行して確認してください。出力のスクリーンショットを添付してください。

こんなクエストを作れるなんて、本当にすごいです。これ、大好きです。

とにかく、答えを提出したら私がレビューできるように、何らかの方法で保存することを忘れないでください。グッドラック！！
